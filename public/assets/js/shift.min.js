const startButtonEl=$(".startButtonEl"),endButtonEl=$(".endButtonEl"),lineTimeStartEl=$(".lineTimeStartEl"),lineTimeEndEl=$(".lineTimeEndEl"),billingNumEl=$("#billingNum"),newProjectNameEl=$("#newProjectName"),newProjectBtnEl=$(".newProjectBtn"),projectDropDownListEl=$(".projectDropDownListEl"),endShiftButtonEl=$(".endShiftButtonEl"),projectLineItem=$(".histBtn"),userIDEl=$(".userIDEl");19===lineTimeStartEl.text().length&&startButtonEl.hide();const time=moment(),timeFormatted=time.format("YYYY-MM-DD HH:mm:ss");startButtonEl.on("click",a=>{a.preventDefault(),startButtonEl.hide("medium"),lineTimeStartEl.text(timeFormatted)}),endButtonEl.on("click",a=>{a.preventDefault(),lineTimeEndEl.text(moment().format("YYYY-MM-DD HH:mm:ss"));const b={projectId:projectLineItem.attr("id"),userId:userIDEl.attr("id"),timeIn:lineTimeStartEl.text(),timeOut:lineTimeEndEl.text()};return b.projectId?"---"===b.timeIn?(lineTimeEndEl.text("---"),void swal({icon:"error",title:"Please Start Shift"})):void postRequest(b):(lineTimeEndEl.text("---"),void swal({icon:"error",title:"Please Choose Valid Project"}))});function postRequest(a){$.post("/api/newInstance",a,()=>{location.reload()})}newProjectBtnEl.on("click",a=>{a.preventDefault();const b={projectNumber:billingNumEl.val().trim(),projectName:newProjectNameEl.val().trim()};return""===b.projectNumber||""===b.projectName?void swal({icon:"error",title:"Please Enter a Valid Project Name or a Valid Project Number"}):void $.post("/api/newProject",b).then(a=>{$.get("/api/project/"+a.id).then(a=>{projectLineItem.text(a.projectName),projectLineItem.attr("id",a.id)})})}),$(".timeSpent").each(function(){const a=$(this).prev().prev().data("timein"),b=$(this).prev().data("timeout"),c=moment(a.split(" ").join("T")),d=moment(b.split(" ").join("T")),e=d.diff(c,"hours",!0);$(this).text(e.toFixed(2))}),projectDropDownListEl.on("click",a=>{a.preventDefault();const b=$(a.target).text();projectLineItem.text(b);const c=$(a.target).attr("id");projectLineItem.attr("id",c)}),endShiftButtonEl.on("click",a=>{function b(a){const b=[];for(let c=0;c<a.length;c++){const d={ProjectId:a[c].ProjectId,projectName:a[c].projectName,timeSpent:[a[c].timeSpent]};b.push(d)}const d=b.reduce((a,b)=>(a[b.ProjectId]?a[b.ProjectId].timeSpent.push(...b.timeSpent):a[b.ProjectId]={...b},a),{}),e=Object.values(d),f=[],g=[],h=[];for(let b=0;b<e.length;b++){const a=e[b].timeSpent.reduce((a,b)=>a+b),c={ProjectId:e[b].ProjectId,projectName:e[b].projectName,timeSpent:a.toFixed(2)};f.push(c),g.push(`${e[b].projectName} ${parseFloat(a.toFixed(2))} hrs`),h.push(parseFloat(a.toFixed(2)))}c(g,h)}function c(a,b){const c=[];for(let d=0;d<a.length;d++){const a=Math.round,b=Math.random,d="rgb("+a(b()*255)+","+a(b()*255)+","+a(b()*255)+")";c.push(d)}const d=document.getElementById("myChart").getContext("2d"),e=new Chart(d,{type:"doughnut",data:{labels:a,datasets:[{label:"Shift Time",data:b,backgroundColor:c,borderWidth:1}]},options:{tooltips:{titleFontSize:16,bodyFontSize:16,callbacks:{label:function(a,b){return b.labels[a.index]}}},legend:{labels:{fontSize:24}},scales:{yAxes:[{ticks:{display:!1}}]}}});console.log(e)}a.preventDefault();const d=a=>{for(let b=0;b<a.length;b++){const c=a[b],d=c.timeIn,e=c.timeOut,f=moment(d.split(" ").join("T")),g=moment(e.split(" ").join("T")),h=g.diff(f,"hours",!0);c.timeSpent=h}},e=userIDEl.attr("id");$.get("/api/chartingInstances/"+e).then(a=>{d(a),b(a)})});